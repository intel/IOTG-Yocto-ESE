# overrides for using squashfs compressed image
# CAUTION: booting with slimboot is NOT SUPPORTED
#
# CAVEATS:
# 1. grub does not yet support actually searching by PARTUUID, the initial grub root will still be found by FAT label name as before, it will look for "efi"
# 2. Root and alternate partition is assumed to be partitions 2 and 3 in relative to efi partition
# 3. Mender updates not supported or tested yet

# GPT Partition UUIDs, generated by uuidgen (these are not filesystem UUIDs)
WKS_PARTUUID_ESP   = "fb86ef3d-d450-491c-84f4-31a2b7923082"
WKS_PARTUUID_ROOTA = "a0d079ba-e220-4b5e-89b7-0bd80c6d1a3c"
WKS_PARTUUID_ROOTB = "13a1661b-a4b6-4455-bb2e-5a04d77a4533"
WKS_PARTUUID_DATA  = "4526f484-eab4-463d-8a4b-e8f8e1ed740f"
WKS_PARTUUID_SWAP  = "b0989699-ebee-41b9-a973-e30ae864efdd"

# custom mender that uses fixed PARTUUID
WKS_FILE = "mender-io-squashfs.wks.in"
WKS_ESP_HINT = "PARTUUID=${WKS_PARTUUID_ESP}"
WKS_ROOTA_HINT = "PARTUUID=${WKS_PARTUUID_ROOTA}"
WKS_ROOTB_HINT = "PARTUUID=${WKS_PARTUUID_ROOTB}"
WKS_DATA_HINT = "PARTUUID=${WKS_PARTUUID_DATA}"
WKS_SWAP_HINT = "PARTUUID=${WKS_PARTUUID_SWAP}"
# this is already set by default in ese-x86-image.inc
# WKS_RESUME_HINT = "${WKS_SWAP_HINT}"


# Using squashfs-xz
IMAGE_FSTYPES:append = " squashfs-xz"
WKS_ROOT_FS = "squashfs-xz"
do_image_wic[recrdeptask] += "do_image_squashfs_xz"

# sizing options
WKS_ROOT_SIZE_MB = "4096"
WKS_DATA_SIZE_MB = "8192"
WKS_BOOT_SIZE_MB = "128"
WKS_SWAP_SIZE_MB = "4096"
